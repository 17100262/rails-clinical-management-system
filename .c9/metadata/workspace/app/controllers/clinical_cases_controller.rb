{"changed":true,"filter":false,"title":"clinical_cases_controller.rb","tooltip":"/app/controllers/clinical_cases_controller.rb","value":"class ClinicalCasesController < ApplicationController\n  before_action :set_clinical_case, only: [:show, :edit, :update, :destroy]\n  before_action :authenticate_user!\n  authorize_resource\n\n  # GET /clinical_cases\n  # GET /clinical_cases.json\n  def index\n    @clinical_cases = ClinicalCase.all\n    @clinical_cases = current_user.clinical_cases if params[:me]==\"true\"\n  end\n  \n\n  # GET /clinical_cases/1\n  # GET /clinical_cases/1.json\n  def show\n    respond_to do |format|\n      format.html\n      format.xls\n    end\n  end\n\n  # GET /clinical_cases/new\n  def new\n    @clinical_case = current_user.clinical_cases.new\n    @clinical_case.imaging_controls.build\n  end\n\n  # GET /clinical_cases/1/edit\n  def edit\n  end\n\n  # POST /clinical_cases\n  # POST /clinical_cases.json\n  def create\n    @clinical_case = current_user.clinical_cases.new(clinical_case_params)\n\n    respond_to do |format|\n      if @clinical_case.save\n        format.html { redirect_to @clinical_case, notice: 'Caso clínico criado com sucesso.' }\n        format.json { render :show, status: :created, location: @clinical_case }\n      else\n        format.html { render :new }\n        format.json { render json: @clinical_case.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /clinical_cases/1\n  # PATCH/PUT /clinical_cases/1.json\n  def update\n    \n    respond_to do |format|\n      if @clinical_case.update(clinical_case_params)\n        @clinical_case.satisfaction_survey_record_discharge.destroy if clinical_case_params[:satisfaction_survey_record_discharge]==\"\"\n        @clinical_case.satisfaction_survey_record_first.destroy if clinical_case_params[:satisfaction_survey_record_first]==\"\"\n        @clinical_case.satisfaction_survey_record_next.destroy if clinical_case_params[:satisfaction_survey_record_next]==\"\"\n        \n        format.html { redirect_to @clinical_case, notice: 'Caso clínico actualizado com sucesso.' }\n        format.json { render :show, status: :ok, location: @clinical_case }\n      else\n        format.html { render :edit }\n        format.json { render json: @clinical_case.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /clinical_cases/1\n  # DELETE /clinical_cases/1.json\n  def destroy\n    @clinical_case.destroy\n    respond_to do |format|\n      format.html { redirect_to clinical_cases_url, notice: 'Caso clínico destoi.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_clinical_case\n      @clinical_case = ClinicalCase.find(params[:id])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def clinical_case_params\n      params.require(:clinical_case).permit(:date_of_birth,:date_of_diagnostic,:histology_type,:histology_level,:estrogen_receptors,:progesterone_receptors,:her2,:ki67,:estadiamento_clinico,:neoadjuvant_systemic_treatment,:surgery_date,:surgery_type,:sentinel_ganglion, :axillary_emptying, :adjuvant_chemotherapy,:adjuvant_radiotherapy,:adjuvant_hormone_therapy_duration,:adjuvant_hormone_therapy_treatment, :date_of_ipo_discharge, :first_follow_up_at_mgf,:date_of_suspected_recurrence_local_recurrence, :date_of_suspected_recurrence_collateral_breast_cancer, :date_of_suspected_recurrence_distance_metastasis, :date_of_suspected_recurrence_second_neoplasm,:date_of_confirmation_of_recurrence, :global_survival, :Specif_breast_cancer_survival, :last_contact_or_death, :death_cause, \n        :satisfaction_survey_record_discharge_text ,\n        :satisfaction_survey_record_discharge, \n        :satisfaction_survey_record_first_text, \n        :satisfaction_survey_record_first, \n        :satisfaction_survey_record_next_text, \n        :satisfaction_survey_record_next,\n        :unique_identifier, \n        imaging_controls_attributes:[:date_of_imaging,:mammography,:eco_breast,:result,:_destroy,:id])\n      \n      \n    end\nend\n","undoManager":{"mark":-14,"position":100,"stack":[[{"start":{"row":39,"column":70},"end":{"row":39,"column":71},"action":"insert","lines":["o"],"id":305}],[{"start":{"row":39,"column":71},"end":{"row":39,"column":72},"action":"insert","lines":[" "],"id":306}],[{"start":{"row":39,"column":72},"end":{"row":39,"column":73},"action":"insert","lines":["c"],"id":307}],[{"start":{"row":39,"column":73},"end":{"row":39,"column":74},"action":"insert","lines":["r"],"id":308}],[{"start":{"row":39,"column":74},"end":{"row":39,"column":75},"action":"insert","lines":["i"],"id":309}],[{"start":{"row":39,"column":75},"end":{"row":39,"column":76},"action":"insert","lines":["a"],"id":310}],[{"start":{"row":39,"column":76},"end":{"row":39,"column":77},"action":"insert","lines":["d"],"id":311}],[{"start":{"row":39,"column":77},"end":{"row":39,"column":78},"action":"insert","lines":["o"],"id":312}],[{"start":{"row":39,"column":78},"end":{"row":39,"column":79},"action":"insert","lines":[" "],"id":313}],[{"start":{"row":39,"column":79},"end":{"row":39,"column":80},"action":"insert","lines":["c"],"id":314}],[{"start":{"row":39,"column":80},"end":{"row":39,"column":81},"action":"insert","lines":["o"],"id":315}],[{"start":{"row":39,"column":81},"end":{"row":39,"column":82},"action":"insert","lines":["m"],"id":316}],[{"start":{"row":39,"column":82},"end":{"row":39,"column":83},"action":"insert","lines":[" "],"id":317}],[{"start":{"row":39,"column":83},"end":{"row":39,"column":84},"action":"insert","lines":["s"],"id":318}],[{"start":{"row":39,"column":84},"end":{"row":39,"column":85},"action":"insert","lines":["u"],"id":319}],[{"start":{"row":39,"column":85},"end":{"row":39,"column":86},"action":"insert","lines":["c"],"id":320}],[{"start":{"row":39,"column":86},"end":{"row":39,"column":87},"action":"insert","lines":["e"],"id":321}],[{"start":{"row":39,"column":87},"end":{"row":39,"column":88},"action":"insert","lines":["s"],"id":322}],[{"start":{"row":39,"column":88},"end":{"row":39,"column":89},"action":"insert","lines":["s"],"id":323}],[{"start":{"row":39,"column":89},"end":{"row":39,"column":90},"action":"insert","lines":["o"],"id":324}],[{"start":{"row":58,"column":59},"end":{"row":58,"column":97},"action":"remove","lines":["Clinical case was successfully updated"],"id":325},{"start":{"row":58,"column":59},"end":{"row":58,"column":60},"action":"insert","lines":["C"]}],[{"start":{"row":58,"column":60},"end":{"row":58,"column":61},"action":"insert","lines":["a"],"id":326}],[{"start":{"row":58,"column":61},"end":{"row":58,"column":62},"action":"insert","lines":["s"],"id":327}],[{"start":{"row":58,"column":62},"end":{"row":58,"column":63},"action":"insert","lines":["o"],"id":328}],[{"start":{"row":58,"column":63},"end":{"row":58,"column":64},"action":"insert","lines":[" "],"id":329}],[{"start":{"row":58,"column":64},"end":{"row":58,"column":65},"action":"insert","lines":["c"],"id":330}],[{"start":{"row":58,"column":65},"end":{"row":58,"column":66},"action":"insert","lines":["l"],"id":331}],[{"start":{"row":58,"column":66},"end":{"row":58,"column":67},"action":"insert","lines":["í"],"id":332}],[{"start":{"row":58,"column":67},"end":{"row":58,"column":68},"action":"insert","lines":["i"],"id":333}],[{"start":{"row":58,"column":67},"end":{"row":58,"column":68},"action":"remove","lines":["i"],"id":334}],[{"start":{"row":58,"column":67},"end":{"row":58,"column":68},"action":"insert","lines":["n"],"id":335}],[{"start":{"row":58,"column":68},"end":{"row":58,"column":69},"action":"insert","lines":["i"],"id":336}],[{"start":{"row":58,"column":69},"end":{"row":58,"column":70},"action":"insert","lines":["c"],"id":337}],[{"start":{"row":58,"column":70},"end":{"row":58,"column":71},"action":"insert","lines":["o"],"id":338}],[{"start":{"row":58,"column":71},"end":{"row":58,"column":72},"action":"insert","lines":[" "],"id":339}],[{"start":{"row":58,"column":72},"end":{"row":58,"column":73},"action":"insert","lines":["a"],"id":340}],[{"start":{"row":58,"column":73},"end":{"row":58,"column":74},"action":"insert","lines":["c"],"id":341}],[{"start":{"row":58,"column":74},"end":{"row":58,"column":75},"action":"insert","lines":["t"],"id":342}],[{"start":{"row":58,"column":75},"end":{"row":58,"column":76},"action":"insert","lines":["u"],"id":343}],[{"start":{"row":58,"column":76},"end":{"row":58,"column":77},"action":"insert","lines":["a"],"id":344}],[{"start":{"row":58,"column":77},"end":{"row":58,"column":78},"action":"insert","lines":["l"],"id":345}],[{"start":{"row":58,"column":78},"end":{"row":58,"column":79},"action":"insert","lines":["i"],"id":346}],[{"start":{"row":58,"column":79},"end":{"row":58,"column":80},"action":"insert","lines":["z"],"id":347}],[{"start":{"row":58,"column":80},"end":{"row":58,"column":81},"action":"insert","lines":["a"],"id":348}],[{"start":{"row":58,"column":81},"end":{"row":58,"column":82},"action":"insert","lines":["d"],"id":349}],[{"start":{"row":58,"column":82},"end":{"row":58,"column":83},"action":"insert","lines":["o"],"id":350}],[{"start":{"row":58,"column":83},"end":{"row":58,"column":84},"action":"insert","lines":[" "],"id":351}],[{"start":{"row":58,"column":84},"end":{"row":58,"column":85},"action":"insert","lines":["c"],"id":352}],[{"start":{"row":58,"column":85},"end":{"row":58,"column":86},"action":"insert","lines":["o"],"id":353}],[{"start":{"row":58,"column":86},"end":{"row":58,"column":87},"action":"insert","lines":["m"],"id":354}],[{"start":{"row":58,"column":87},"end":{"row":58,"column":88},"action":"insert","lines":[" "],"id":355}],[{"start":{"row":58,"column":88},"end":{"row":58,"column":89},"action":"insert","lines":["s"],"id":356}],[{"start":{"row":58,"column":89},"end":{"row":58,"column":90},"action":"insert","lines":["u"],"id":357}],[{"start":{"row":58,"column":90},"end":{"row":58,"column":91},"action":"insert","lines":["c"],"id":358}],[{"start":{"row":58,"column":91},"end":{"row":58,"column":92},"action":"insert","lines":["e"],"id":359}],[{"start":{"row":58,"column":92},"end":{"row":58,"column":93},"action":"insert","lines":["e"],"id":360}],[{"start":{"row":58,"column":92},"end":{"row":58,"column":93},"action":"remove","lines":["e"],"id":361}],[{"start":{"row":58,"column":91},"end":{"row":58,"column":92},"action":"remove","lines":["e"],"id":362}],[{"start":{"row":58,"column":90},"end":{"row":58,"column":91},"action":"remove","lines":["c"],"id":363}],[{"start":{"row":58,"column":90},"end":{"row":58,"column":91},"action":"insert","lines":["c"],"id":364}],[{"start":{"row":58,"column":91},"end":{"row":58,"column":92},"action":"insert","lines":["e"],"id":365}],[{"start":{"row":58,"column":92},"end":{"row":58,"column":93},"action":"insert","lines":["s"],"id":366}],[{"start":{"row":58,"column":93},"end":{"row":58,"column":94},"action":"insert","lines":["s"],"id":367}],[{"start":{"row":58,"column":94},"end":{"row":58,"column":95},"action":"insert","lines":["o"],"id":368}],[{"start":{"row":72,"column":61},"end":{"row":72,"column":101},"action":"remove","lines":["Clinical case was successfully destroyed"],"id":369},{"start":{"row":72,"column":61},"end":{"row":72,"column":62},"action":"insert","lines":["c"]}],[{"start":{"row":72,"column":62},"end":{"row":72,"column":63},"action":"insert","lines":["a"],"id":370}],[{"start":{"row":72,"column":63},"end":{"row":72,"column":64},"action":"insert","lines":["s"],"id":371}],[{"start":{"row":72,"column":64},"end":{"row":72,"column":65},"action":"insert","lines":["o"],"id":372}],[{"start":{"row":72,"column":65},"end":{"row":72,"column":66},"action":"insert","lines":[" "],"id":373}],[{"start":{"row":72,"column":66},"end":{"row":72,"column":67},"action":"insert","lines":["c"],"id":374}],[{"start":{"row":72,"column":67},"end":{"row":72,"column":68},"action":"insert","lines":["l"],"id":375}],[{"start":{"row":72,"column":67},"end":{"row":72,"column":68},"action":"remove","lines":["l"],"id":376}],[{"start":{"row":72,"column":66},"end":{"row":72,"column":67},"action":"remove","lines":["c"],"id":377}],[{"start":{"row":72,"column":65},"end":{"row":72,"column":66},"action":"remove","lines":[" "],"id":378}],[{"start":{"row":72,"column":64},"end":{"row":72,"column":65},"action":"remove","lines":["o"],"id":379}],[{"start":{"row":72,"column":63},"end":{"row":72,"column":64},"action":"remove","lines":["s"],"id":380}],[{"start":{"row":72,"column":62},"end":{"row":72,"column":63},"action":"remove","lines":["a"],"id":381}],[{"start":{"row":72,"column":61},"end":{"row":72,"column":62},"action":"remove","lines":["c"],"id":382}],[{"start":{"row":72,"column":61},"end":{"row":72,"column":62},"action":"insert","lines":["C"],"id":383}],[{"start":{"row":72,"column":62},"end":{"row":72,"column":63},"action":"insert","lines":["a"],"id":384}],[{"start":{"row":72,"column":63},"end":{"row":72,"column":64},"action":"insert","lines":["s"],"id":385}],[{"start":{"row":72,"column":64},"end":{"row":72,"column":65},"action":"insert","lines":["o"],"id":386}],[{"start":{"row":72,"column":65},"end":{"row":72,"column":66},"action":"insert","lines":[" "],"id":387}],[{"start":{"row":72,"column":66},"end":{"row":72,"column":67},"action":"insert","lines":["c"],"id":388}],[{"start":{"row":72,"column":67},"end":{"row":72,"column":68},"action":"insert","lines":["l"],"id":389}],[{"start":{"row":72,"column":68},"end":{"row":72,"column":69},"action":"insert","lines":["í"],"id":390}],[{"start":{"row":72,"column":69},"end":{"row":72,"column":70},"action":"insert","lines":["n"],"id":391}],[{"start":{"row":72,"column":70},"end":{"row":72,"column":71},"action":"insert","lines":["i"],"id":392}],[{"start":{"row":72,"column":71},"end":{"row":72,"column":72},"action":"insert","lines":["c"],"id":393}],[{"start":{"row":72,"column":72},"end":{"row":72,"column":73},"action":"insert","lines":["o"],"id":394}],[{"start":{"row":72,"column":73},"end":{"row":72,"column":74},"action":"insert","lines":[" "],"id":395}],[{"start":{"row":72,"column":74},"end":{"row":72,"column":75},"action":"insert","lines":["d"],"id":396}],[{"start":{"row":72,"column":75},"end":{"row":72,"column":76},"action":"insert","lines":["e"],"id":397}],[{"start":{"row":72,"column":76},"end":{"row":72,"column":77},"action":"insert","lines":["s"],"id":398}],[{"start":{"row":72,"column":77},"end":{"row":72,"column":78},"action":"insert","lines":["t"],"id":399}],[{"start":{"row":72,"column":78},"end":{"row":72,"column":79},"action":"insert","lines":["o"],"id":400}],[{"start":{"row":72,"column":79},"end":{"row":72,"column":80},"action":"insert","lines":["i"],"id":401}],[{"start":{"row":72,"column":80},"end":{"row":72,"column":81},"action":"insert","lines":["d"],"id":402}],[{"start":{"row":72,"column":81},"end":{"row":72,"column":82},"action":"insert","lines":["o"],"id":403}],[{"start":{"row":72,"column":81},"end":{"row":72,"column":82},"action":"remove","lines":["o"],"id":404}],[{"start":{"row":72,"column":80},"end":{"row":72,"column":81},"action":"remove","lines":["d"],"id":405}]]},"ace":{"folds":[],"scrolltop":420,"scrollleft":0,"selection":{"start":{"row":72,"column":80},"end":{"row":72,"column":80},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":true,"wrapToView":true},"firstLineState":{"row":34,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1523625295155}